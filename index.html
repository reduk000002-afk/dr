<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trust Wallet Connect</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.7.0/dist/ethers.umd.min.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1a1a; color: white; max-width: 600px; margin: 0 auto; }
        .btn { padding: 12px 24px; background: #3375bb; color: white; border: none; border-radius: 10px; cursor: pointer; margin: 10px 0; font-size: 16px; width: 100%; }
        .btn:hover { background: #2a6099; }
        .btn:disabled { background: #666; cursor: not-allowed; }
        .card { background: #2d2d2d; padding: 20px; border-radius: 15px; margin: 20px 0; border: 1px solid #444; }
        .qr-container { background: white; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center; }
        .instructions { background: #3d3d3d; padding: 15px; border-radius: 10px; margin: 15px 0; font-size: 14px; line-height: 1.6; }
        .hidden { display: none; }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        h2 { color: #3375bb; }
        .trust-icon { color: #3375bb; font-size: 24px; }
        .step { margin: 10px 0; padding: 10px; background: rgba(51, 117, 187, 0.1); border-radius: 8px; }
        .status-bar { padding: 10px; border-radius: 8px; margin: 10px 0; text-align: center; }
        .connected { background: rgba(76, 175, 80, 0.2); border: 1px solid #4CAF50; }
        .disconnected { background: rgba(244, 67, 54, 0.2); border: 1px solid #f44336; }
        .loading { color: #FFC107; }
        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #444; background: #333; color: white; box-sizing: border-box; }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="trust-icon">üîµ</span> –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Trust Wallet</h1>
        
        <div class="card">
            <div class="status-bar disconnected" id="status-bar">
                <h3>‚ùå –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</h3>
                <p>Trust Wallet –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</p>
            </div>
            
            <div id="connection-section">
                <h3>üì± –ü–æ–¥–∫–ª—é—á–∏—Ç–µ Trust Wallet:</h3>
                
                <div class="instructions">
                    <div class="step">1. <strong>–û—Ç–∫—Ä–æ–π—Ç–µ Trust Wallet –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ</strong></div>
                    <div class="step">2. <strong>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ DApps –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞</strong></div>
                    <div class="step">3. <strong>–í–≤–µ–¥–∏—Ç–µ —ç—Ç–æ—Ç URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ:</strong><br>
                        <code style="background: #444; padding: 5px; border-radius: 4px; display: inline-block; margin: 5px 0;" id="current-url"></code>
                    </div>
                    <div class="step">4. <strong>–ù–∞–∂–º–∏—Ç–µ "Connect" –≤ Trust Wallet</strong></div>
                </div>
                
                <button class="btn" onclick="openInTrustWallet()" id="open-btn">
                    üì≤ –û—Ç–∫—Ä—ã—Ç—å –≤ Trust Wallet
                </button>
                
                <button class="btn" onclick="checkTrustWalletConnection()" id="check-btn">
                    üîÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                </button>
                
                <div class="instructions">
                    <p><strong>–ò–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ WalletConnect:</strong></p>
                    <button class="btn" onclick="connectViaWalletConnect()" style="background: #3b99fc;">
                        üîó WalletConnect
                    </button>
                </div>
            </div>
        </div>
        
        <div class="card hidden" id="wallet-info">
            <div class="status-bar connected">
                <h3>‚úÖ Trust Wallet –ø–æ–¥–∫–ª—é—á–µ–Ω!</h3>
                <p>–í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</p>
            </div>
            
            <h3>üí∞ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—à–µ–ª—å–∫–µ:</h3>
            <p><strong>–ê–¥—Ä–µ—Å:</strong> <span id="wallet-address"></span></p>
            <p><strong>–ë–∞–ª–∞–Ω—Å BNB:</strong> <span id="wallet-balance">0</span></p>
            <p><strong>–°–µ—Ç—å:</strong> <span id="wallet-network">BNB Smart Chain</span></p>
            
            <h3>üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é:</h3>
            <div class="form-group">
                <label>–ê–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è:</label>
                <input type="text" id="receiver-address" placeholder="0x..." value="0x0000000000000000000000000000000000000000">
            </div>
            
            <div class="form-group">
                <label>–°—É–º–º–∞ BNB:</label>
                <input type="number" id="amount" value="0.001" step="0.001" min="0" max="1">
            </div>
            
            <button class="btn" onclick="sendTransaction()" id="send-btn">
                üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å BNB
            </button>
            
            <button class="btn" onclick="signMessage()" style="background: #6c757d;">
                ‚úçÔ∏è –ü–æ–¥–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
            </button>
            
            <button class="btn" onclick="disconnectWallet()" style="background: #dc3545;">
                ‚ùå –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è
            </button>
        </div>
        
        <div class="card">
            <h3>üìã –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h3>
            <div class="instructions">
                <p><strong>Trust Wallet —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Å–≤–æ–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ DApps!</strong></p>
                
                <p>‚úÖ <strong>–†–∞–±–æ—Ç–∞–µ—Ç:</strong></p>
                <ul>
                    <li>–û—Ç–∫—Ä—ã—Ç—å Trust Wallet ‚Üí DApps ‚Üí –í–≤–µ—Å—Ç–∏ URL —ç—Ç–æ–≥–æ —Å–∞–π—Ç–∞</li>
                    <li>–ù–∞–∂–∞—Ç—å "Connect" –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Trust Wallet</li>
                    <li>–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏ –Ω–∞ —Å–∞–π—Ç–µ</li>
                </ul>
                
                <p>‚ùå <strong>–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong></p>
                <ul>
                    <li>–û—Ç–∫—Ä—ã—Ç—å —ç—Ç–æ—Ç —Å–∞–π—Ç –≤ Chrome/Safari –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ</li>
                    <li>QR-–∫–æ–¥—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–≤–Ω–µ Trust Wallet)</li>
                    <li>–ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</li>
                </ul>
                
                <p><strong>–î–ª—è —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:</strong></p>
                <ul>
                    <li>BSC Testnet –≤ Trust Wallet</li>
                    <li>–¢–µ—Å—Ç–æ–≤—ã–µ BNB: <a href="https://testnet.binance.org/faucet-smart" style="color: #3375bb;" target="_blank">Faucet</a></li>
                    <li>–ù–µ–±–æ–ª—å—à–∏–µ —Å—É–º–º—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π URL
        document.getElementById('current-url').textContent = window.location.href;
        
        let provider = null;
        let signer = null;
        let userAddress = null;
        let isConnected = false;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Ç–∫—Ä—ã—Ç–æ –ª–∏ –≤ Trust Wallet
        function isInTrustWallet() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            return /TrustWallet/i.test(userAgent) || 
                   window.trustwallet !== undefined ||
                   window.webkit?.messageHandlers?.trustWallet !== undefined;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º Web3 –ø—Ä–æ–≤–∞–π–¥–µ—Ä
        function isWeb3Available() {
            return typeof window.ethereum !== 'undefined' || 
                   typeof window.web3 !== 'undefined' ||
                   isInTrustWallet();
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å –≤ Trust Wallet —á–µ—Ä–µ–∑ deeplink
        function openInTrustWallet() {
            const currentUrl = encodeURIComponent(window.location.href);
            const trustDeeplink = `https://link.trustwallet.com/open_url?coin_id=714&url=${currentUrl}`;
            
            // –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å deeplink
            window.location.href = trustDeeplink;
            
            // –ï—Å–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            setTimeout(() => {
                alert(
                    'üì± Trust Wallet –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.\n\n' +
                    '–°–¥–µ–ª–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é:\n' +
                    '1. –û—Ç–∫—Ä–æ–π—Ç–µ Trust Wallet\n' +
                    '2. –ù–∞–∂–º–∏—Ç–µ DApps –≤–Ω–∏–∑—É\n' +
                    '3. –í–≤–µ–¥–∏—Ç–µ —ç—Ç–æ—Ç URL:\n' +
                    window.location.href + '\n\n' +
                    '4. –ù–∞–∂–º–∏—Ç–µ "Connect"'
                );
            }, 1000);
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Trust Wallet
        async function checkTrustWalletConnection() {
            try {
                document.getElementById('check-btn').disabled = true;
                document.getElementById('check-btn').textContent = 'üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º...';
                
                if (!isWeb3Available()) {
                    throw new Error('Trust Wallet –∏–ª–∏ –¥—Ä—É–≥–æ–π Web3 –∫–æ—à–µ–ª–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });
                
                if (accounts && accounts.length > 0) {
                    userAddress = accounts[0];
                    await setupWallet();
                    showSuccess('‚úÖ Trust Wallet –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                } else {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–∫–∫–∞—É–Ω—Ç–∞–º');
                }
                
            } catch (error) {
                console.error('Connection error:', error);
                
                if (error.code === 4001) {
                    showError('‚ùå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ –≤ Trust Wallet');
                } else if (error.code === -32002) {
                    showError('‚è≥ –ó–∞–ø—Ä–æ—Å —É–∂–µ –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤ Trust Wallet');
                } else {
                    showError('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
                }
                
                document.getElementById('check-btn').disabled = false;
                document.getElementById('check-btn').textContent = 'üîÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ';
            }
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ—à–µ–ª—å–∫–∞
        async function setupWallet() {
            try {
                provider = new ethers.BrowserProvider(window.ethereum);
                signer = await provider.getSigner();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Ç—å
                await checkNetwork();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                updateUI(true);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                await updateWalletInfo();
                
                document.getElementById('check-btn').disabled = false;
                document.getElementById('check-btn').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
                
            } catch (error) {
                console.error('Setup error:', error);
                throw error;
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å
        async function checkNetwork() {
            try {
                const network = await provider.getNetwork();
                const bscChainId = 56n; // BSC Mainnet
                const bscTestnetChainId = 97n; // BSC Testnet
                
                if (network.chainId !== bscChainId && network.chainId !== bscTestnetChainId) {
                    const switchTo = confirm(
                        '‚ö†Ô∏è –í—ã –Ω–µ –≤ —Å–µ—Ç–∏ BNB Smart Chain!\n\n' +
                        '–¢–µ–∫—É—â–∞—è —Å–µ—Ç—å: ' + network.name + '\n' +
                        '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ BNB Smart Chain?'
                    );
                    
                    if (switchTo) {
                        try {
                            await window.ethereum.request({
                                method: 'wallet_switchEthereumChain',
                                params: [{ chainId: '0x38' }] // 56 –≤ hex
                            });
                        } catch (switchError) {
                            if (switchError.code === 4902) {
                                // –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ç—å –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
                                await window.ethereum.request({
                                    method: 'wallet_addEthereumChain',
                                    params: [{
                                        chainId: '0x38',
                                        chainName: 'BNB Smart Chain',
                                        nativeCurrency: {
                                            name: 'BNB',
                                            symbol: 'BNB',
                                            decimals: 18
                                        },
                                        rpcUrls: ['https://bsc-dataseed.binance.org/'],
                                        blockExplorerUrls: ['https://bscscan.com']
                                    }]
                                });
                            }
                        }
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ—Ç–∏
                const networkName = network.chainId === bscChainId ? 
                    'BNB Smart Chain' : 
                    network.chainId === bscTestnetChainId ? 
                    'BSC Testnet' : 
                    network.name;
                
                document.getElementById('wallet-network').textContent = networkName;
                
            } catch (error) {
                console.error('Network check error:', error);
            }
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ—à–µ–ª—å–∫–µ
        async function updateWalletInfo() {
            if (!userAddress || !provider) return;
            
            try {
                // –ê–¥—Ä–µ—Å
                const shortAddress = userAddress.substring(0, 6) + '...' + userAddress.substring(userAddress.length - 4);
                document.getElementById('wallet-address').textContent = shortAddress;
                document.getElementById('wallet-address').title = userAddress;
                
                // –ë–∞–ª–∞–Ω—Å
                const balance = await provider.getBalance(userAddress);
                const network = await provider.getNetwork();
                const symbol = network.chainId === 97n ? 'tBNB' : 'BNB';
                document.getElementById('wallet-balance').textContent = 
                    ethers.formatEther(balance).substring(0, 8) + ' ' + symbol;
                
            } catch (error) {
                console.error('Update wallet info error:', error);
                document.getElementById('wallet-balance').textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
            }
        }
        
        // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        async function sendTransaction() {
            if (!signer) {
                showError('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Trust Wallet!');
                return;
            }
            
            const to = document.getElementById('receiver-address').value.trim();
            const amount = document.getElementById('amount').value;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∏
            if (!to || to.length !== 42 || !to.startsWith('0x')) {
                showError('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è!');
                return;
            }
            
            if (!amount || parseFloat(amount) <= 0) {
                showError('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É!');
                return;
            }
            
            try {
                document.getElementById('send-btn').disabled = true;
                document.getElementById('send-btn').textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...';
                
                showMessage('üì± –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ Trust Wallet...');
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
                const tx = await signer.sendTransaction({
                    to: to,
                    value: ethers.parseEther(amount),
                    chainId: 56
                });
                
                showSuccess(`‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!\n\n–•—ç—à: ${tx.hash.substring(0, 10)}...`);
                
                // –ñ–¥–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
                showMessage('‚è≥ –û–∂–∏–¥–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–µ—Ç–∏...');
                const receipt = await tx.wait();
                
                showSuccess(`‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!\n\n–ë–ª–æ–∫: ${receipt.blockNumber}`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
                await updateWalletInfo();
                
            } catch (error) {
                console.error('Send error:', error);
                
                let errorMsg = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ';
                if (error.code === 4001) {
                    errorMsg += '–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ –≤ Trust Wallet';
                } else if (error.message.includes('insufficient funds')) {
                    errorMsg += '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤';
                } else {
                    errorMsg += error.message;
                }
                
                showError(errorMsg);
                
            } finally {
                document.getElementById('send-btn').disabled = false;
                document.getElementById('send-btn').textContent = 'üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å BNB';
            }
        }
        
        // –ü–æ–¥–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        async function signMessage() {
            if (!signer) {
                showError('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Trust Wallet!');
                return;
            }
            
            try {
                const message = "–ü–æ–¥–ø–∏—Å—å –¥–ª—è Trust Wallet Connect " + Date.now();
                const signature = await signer.signMessage(message);
                
                showSuccess(`‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ!\n\n–ü–æ–¥–ø–∏—Å—å: ${signature.substring(0, 20)}...`);
                
            } catch (error) {
                console.error('Sign error:', error);
                showError('–û—à–∏–±–∫–∞ –ø–æ–¥–ø–∏—Å–∏: ' + (error.code === 4001 ? '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ –≤ Trust Wallet' : error.message));
            }
        }
        
        // WalletConnect (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥)
        function connectViaWalletConnect() {
            alert(
                'üîó WalletConnect –¥–ª—è Trust Wallet:\n\n' +
                '1. –û—Ç–∫—Ä–æ–π—Ç–µ Trust Wallet –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ\n' +
                '2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí WalletConnect\n' +
                '3. "–ù–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ"\n' +
                '4. –û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:\n\n' +
                'https://example-walletconnect.com'
            );
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WalletConnect
            // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –æ—Ç–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä
            window.open('https://example-walletconnect.com', '_blank');
        }
        
        // –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è
        function disconnectWallet() {
            provider = null;
            signer = null;
            userAddress = null;
            isConnected = false;
            
            updateUI(false);
            showMessage('üîå Trust Wallet –æ—Ç–∫–ª—é—á–µ–Ω');
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å UI
        function updateUI(connected) {
            const connectionSection = document.getElementById('connection-section');
            const walletInfo = document.getElementById('wallet-info');
            const statusBar = document.getElementById('status-bar');
            
            if (connected) {
                connectionSection.classList.add('hidden');
                walletInfo.classList.remove('hidden');
                statusBar.className = 'status-bar connected';
                statusBar.innerHTML = '<h3>‚úÖ Trust Wallet –ø–æ–¥–∫–ª—é—á–µ–Ω!</h3><p>–í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</p>';
            } else {
                connectionSection.classList.remove('hidden');
                walletInfo.classList.add('hidden');
                statusBar.className = 'status-bar disconnected';
                statusBar.innerHTML = '<h3>‚ùå –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</h3><p>Trust Wallet –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</p>';
            }
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
        function showMessage(text) {
            alert(text);
        }
        
        function showSuccess(text) {
            alert(text);
        }
        
        function showError(text) {
            alert(text);
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, –µ—Å–ª–∏ —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
        window.addEventListener('load', async () => {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å Trust Wallet
            if (isInTrustWallet()) {
                console.log('–û—Ç–∫—Ä—ã—Ç–æ –≤ Trust Wallet');
                document.getElementById('open-btn').textContent = 'üì± –û—Ç–∫—Ä—ã—Ç–æ –≤ Trust Wallet';
                document.getElementById('open-btn').disabled = true;
                
                // –ü—Ä–æ–±—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
                if (isWeb3Available()) {
                    setTimeout(async () => {
                        try {
                            const accounts = await window.ethereum.request({ 
                                method: 'eth_accounts' 
                            });
                            
                            if (accounts && accounts.length > 0) {
                                userAddress = accounts[0];
                                await setupWallet();
                                showSuccess('‚úÖ Trust Wallet –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                            }
                        } catch (error) {
                            console.log('Auto-connect failed:', error);
                        }
                    }, 1000);
                }
            }
            
            // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤
            if (window.ethereum) {
                window.ethereum.on('accountsChanged', (accounts) => {
                    if (accounts.length > 0) {
                        userAddress = accounts[0];
                        updateWalletInfo();
                        showMessage('üë§ –ê–∫–∫–∞—É–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω');
                    } else {
                        disconnectWallet();
                    }
                });
                
                window.ethereum.on('chainChanged', () => {
                    window.location.reload();
                });
            }
        });
    </script>
</body>
</html>
